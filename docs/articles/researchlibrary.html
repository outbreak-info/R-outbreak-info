<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Research Library • outbreakinfo</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Research Library">
<meta property="og:description" content="outbreakinfo">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VK9KSJ8ENE"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VK9KSJ8ENE');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">outbreakinfo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/outbreakinfo.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/epivignette.html">Cases &amp; Deaths data</a>
    </li>
    <li>
      <a href="../articles/locationtracker.html">Location Tracker</a>
    </li>
    <li>
      <a href="../articles/researchlibrary.html">Research Library</a>
    </li>
    <li>
      <a href="../articles/varianttracker.html">Variant Tracker</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/outbreak-info/R-outbreak-info/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="researchlibrary_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="researchlibrary_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="researchlibrary_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Research Library</h1>
            
            <h4 class="date">03 November 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/outbreak-info/R-outbreak-info/blob/master/vignettes/researchlibrary.Rmd"><code>vignettes/researchlibrary.Rmd</code></a></small>
      <div class="hidden name"><code>researchlibrary.Rmd</code></div>

    </div>

    
    
<div id="accessing-the-data-in-outbreak-infos-research-library" class="section level1">
<h1 class="hasAnchor">
<a href="#accessing-the-data-in-outbreak-infos-research-library" class="anchor"></a>Accessing the data in outbreak.info’s Research Library</h1>
<p>outbreak.info’s Research Library allows you to track the vast amount of research being produced by the community on COVID-19, including publications, clinical trials, datasets, protocols, and more. The metadata for these resources are pulled every day across a series of <a href="https://outbreak.info/sources#resources">data sources</a> and combined and standardized for easy searching across data asset.</p>
<p>Here, we’ll show how to access and filter these metadata about COVID-19 and SARS-CoV-2 research.</p>
<div id="before-we-start" class="section level2">
<h2 class="hasAnchor">
<a href="#before-we-start" class="anchor"></a>Before we start…</h2>
<p>Import the packages we’ll use.</p>
<p>Note that unlike the <a href="https://outbreak-info.github.io/R-outbreak-info/reference/index.html#section-sars-cov-variant-prevalence">SARS-CoV-2 Variant Prevalence functions</a>, none of the Research Library functions or anything in this vignette require GISAID authentication through the <code><a href="../reference/authenticateUser.html">authenticateUser()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://outbreak-info.github.io/R-outbreak-info/">outbreakinfo</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'jsonlite::flatten' by 'purrr::flatten' when</span>
<span class="co">#&gt; loading 'outbreakinfo'</span>

<span class="co"># For some data manipulation and plotting</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="access-how-many-resources-are-collected-by-date" class="section level2">
<h2 class="hasAnchor">
<a href="#access-how-many-resources-are-collected-by-date" class="anchor"></a>Access how many resources are collected by date</h2>
<p>How has the amount of research changed over time? We can pull the resources added each week to understand the scale of the vast amount of COVID-19 research being produced since the beginning of the pandemic.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># query the API to get the resources by date. Filter to &gt; 1 January 2020, to remove the weirdos that slipped through.</span>
<span class="va">resources_by_date</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"date:[2020-01-01 TO *]"</span>, fields <span class="op">=</span> <span class="st">"date"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># roll up the number of resources by week</span>
<span class="va">resources_by_date</span> <span class="op">=</span> <span class="va">resources_by_date</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,
         iso_week <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/week.html">isoweek</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>

<span class="co"># count the number of new resources per week.</span>
<span class="va">resources_per_week</span> <span class="op">=</span> <span class="va">resources_by_date</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">iso_week</span>, <span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># convert from iso week back to a date</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>iso_date <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html">parse_date_time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">year</span>,<span class="va">iso_week</span>, <span class="st">"Mon"</span>, sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span>, <span class="st">"Y-W-a"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 369 in year</span>
<span class="co">#&gt; 2020 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 367 in year</span>
<span class="co">#&gt; 2021 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 369 in year</span>
<span class="co">#&gt; 2020 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 367 in year</span>
<span class="co">#&gt; 2021 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 369 in year</span>
<span class="co">#&gt; 2020 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 367 in year</span>
<span class="co">#&gt; 2021 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 369 in year</span>
<span class="co">#&gt; 2020 is invalid</span>
<span class="co">#&gt; Warning in strptime(.enclose(x), .enclose(fmt), tz): (0-based) yday 367 in year</span>
<span class="co">#&gt; 2021 is invalid</span>
<span class="co">#&gt; Warning: 2 failed to parse.</span>

<span class="co"># plot!</span>
<span class="va">fill_color</span> <span class="op">=</span> <span class="st">"#66c2a5"</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">resources_per_week</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iso_date</span>, y <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">fill_color</span>, stat<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"COVID-19 resources have rapidly proliferated"</span>, subtitle<span class="op">=</span><span class="st">"Number of publications, datasets, clinical trials, and more added each week to outbreak.info's Research Library"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family<span class="op">=</span><span class="st">"DM Sans"</span><span class="op">)</span>,
    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,
    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"#777777"</span>, size<span class="op">=</span><span class="fl">9</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>label<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_number.html">comma</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_datetime</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">resources_per_week</span><span class="op">$</span><span class="va">iso_date</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">resources_per_week</span><span class="op">$</span><span class="va">iso_date</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, date_labels <span class="op">=</span> <span class="st">"%b %Y"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (position_stack).</span>
<span class="co">#&gt; Warning: Removed 2 rows containing missing values (geom_bar).</span></code></pre></div>
<p><img src="researchlibrary_files/figure-html/resources_by_date-1.png" width="100%"></p>
</div>
<div id="count-how-many-resources-there-are-by-type" class="section level2">
<h2 class="hasAnchor">
<a href="#count-how-many-resources-there-are-by-type" class="anchor"></a>Count how many resources there are by type</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We COULD grab the resources by querying the index just to pull out the `@type` field, and then using dplyr to summarise the data.</span>
<span class="va">resources_by_type_slow_way</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>fields<span class="op">=</span><span class="st">"@type"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">resources_by_type_slow_way_summary</span> <span class="op">=</span> <span class="va">resources_by_type_slow_way</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">`@type`</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">resources_by_type_slow_way_summary</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"><span class="citation">@type</span></th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Publication</td>
<td align="right">200078</td>
</tr>
<tr class="even">
<td align="left">ClinicalTrial</td>
<td align="right">12280</td>
</tr>
<tr class="odd">
<td align="left">Dataset</td>
<td align="right">3868</td>
</tr>
<tr class="even">
<td align="left">Protocol</td>
<td align="right">752</td>
</tr>
<tr class="odd">
<td align="left">ImageObject</td>
<td align="right">227</td>
</tr>
<tr class="even">
<td align="left">SoftwareSourceCode</td>
<td align="right">197</td>
</tr>
<tr class="odd">
<td align="left">CreativeWork</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td align="left">PresentationDigitalDocument</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td align="left">MediaObject</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">Book</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">Website</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">Analysis</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Educational Resource</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">Report</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">WebPage</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">Conference Contribution</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">Article</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">BreadcrumbList</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Photograph</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># ... but the API actually will count variables for us, which is loads faster.</span>
<span class="co"># Note: we'll need to change `facet_size` from its default of 10, to make sure all the types are returned.</span>
<span class="va">resources_by_type_response</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>facets<span class="op">=</span><span class="st">"@type"</span>, facet_size <span class="op">=</span> <span class="fl">50</span>, size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co"># The results are stored in `resources_by_type_response$facets$`@type`$terms`:</span>
<span class="va">resources_by_type</span> <span class="op">=</span> <span class="va">resources_by_type_response</span><span class="op">$</span><span class="va">facets</span><span class="op">$</span><span class="va">`@type`</span><span class="op">$</span><span class="va">terms</span>
<span class="co"># And we get the same data, but without having to make those lengthy calls to grab all the data and then count them.</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">resources_by_type</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">count</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">term</th>
<th align="right">count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Publication</td>
<td align="right">200078</td>
</tr>
<tr class="even">
<td align="left">ClinicalTrial</td>
<td align="right">12280</td>
</tr>
<tr class="odd">
<td align="left">Dataset</td>
<td align="right">3868</td>
</tr>
<tr class="even">
<td align="left">Protocol</td>
<td align="right">752</td>
</tr>
<tr class="odd">
<td align="left">ImageObject</td>
<td align="right">227</td>
</tr>
<tr class="even">
<td align="left">SoftwareSourceCode</td>
<td align="right">197</td>
</tr>
<tr class="odd">
<td align="left">CreativeWork</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td align="left">PresentationDigitalDocument</td>
<td align="right">97</td>
</tr>
<tr class="odd">
<td align="left">MediaObject</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="left">Book</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="left">Website</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">Analysis</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Educational Resource</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">Report</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">WebPage</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">Conference Contribution</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">Article</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">BreadcrumbList</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Photograph</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="count-how-many-resources-there-are-by-type-and-by-data-source" class="section level2">
<h2 class="hasAnchor">
<a href="#count-how-many-resources-there-are-by-type-and-by-data-source" class="anchor"></a>Count how many resources there are by type AND by data source</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">getSources</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">facets</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span>, facets<span class="op">=</span><span class="st">"curatedBy.name"</span>, facet_size <span class="op">=</span> <span class="fl">50</span>, size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

  <span class="va">terms</span> <span class="op">=</span> <span class="va">facets</span><span class="op">$</span><span class="va">facets</span><span class="op">$</span><span class="va">curatedBy.name</span><span class="op">$</span><span class="va">terms</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="va">type</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Map over each of the types to get the source counts for each</span>
<span class="va">resources_by_source</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">resources_by_type</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span>, <span class="va">getSources</span><span class="op">)</span>

<span class="co"># Get the resources by source, to order the totals</span>
<span class="va">resources_by_curator</span> <span class="op">=</span>  <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>facets<span class="op">=</span><span class="st">"curatedBy.name"</span>, facet_size <span class="op">=</span> <span class="fl">50</span>, size <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">resources_by_curator</span> <span class="op">=</span> <span class="va">resources_by_curator</span><span class="op">$</span><span class="va">facets</span><span class="op">$</span><span class="va">curatedBy.name</span><span class="op">$</span><span class="va">terms</span><span class="op">$</span><span class="va">term</span>

<span class="co"># Group together fields into "other" category</span>
<span class="va">resources_by_source_grouped</span> <span class="op">=</span> <span class="va">resources_by_source</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type_grouped <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">type</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Publication"</span>, <span class="st">"ClinicalTrial"</span>, <span class="st">"Dataset"</span>, <span class="st">"Protocol"</span><span class="op">)</span>,
                               <span class="va">type</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">type_grouped</span>, <span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'type_grouped'. You can override using the `.groups` argument.</span>


<span class="co"># Set the levels, so the bar plot sorts by order.</span>
<span class="va">types</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Other"</span>, <span class="va">resources_by_type</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">resources_by_source_grouped</span><span class="op">$</span><span class="va">type_grouped</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">resources_by_source_grouped</span><span class="op">$</span><span class="va">type_grouped</span>, <span class="va">types</span><span class="op">)</span>
<span class="va">resources_by_source_grouped</span><span class="op">$</span><span class="va">term</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">resources_by_source_grouped</span><span class="op">$</span><span class="va">term</span>, <span class="va">resources_by_curator</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="va">COLORPALETTE</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4E79A7"</span>, <span class="st">"#f28e2b"</span>, <span class="st">"#59a14f"</span>,<span class="st">"#e15759"</span>, <span class="st">"#499894"</span>,<span class="st">"#B6992D"</span>,  <span class="st">"#D37295"</span>, <span class="st">"#B07AA1"</span>,<span class="st">"#9D7660"</span>, <span class="st">"#bcbd22"</span>,
                 <span class="st">"#aecBe8"</span>, <span class="st">"#FFBE7D"</span>,  <span class="st">"#8CD17D"</span>, <span class="st">"#FF9D9A"</span>,  <span class="st">"#86BCB6"</span>, <span class="st">"#F1CE63"</span>,<span class="st">"#FABFD2"</span>,  <span class="st">"#D4A6C8"</span>, <span class="st">"#D7B5A6"</span>,  <span class="st">"#79706E"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">COLORPALETTE</span><span class="op">)</span> <span class="op">=</span> <span class="va">resources_by_curator</span>


<span class="co"># Plot the results -- full scale to encapsulate the LitCovid responses</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">resources_by_source_grouped</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type_grouped</span> <span class="op">!=</span> <span class="st">"Other"</span><span class="op">)</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">type_grouped</span>, y <span class="op">=</span> <span class="va">count</span>, fill <span class="op">=</span> <span class="va">term</span>, colour <span class="op">=</span> <span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge2</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span>, preserve <span class="op">=</span> <span class="st">"single"</span>, padding <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">count</span> <span class="op">+</span> <span class="fl">1500</span>, label <span class="op">=</span> <span class="va">term</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge2</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span>, preserve <span class="op">=</span> <span class="st">"single"</span>, padding <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,
            size <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_number.html">comma</a></span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">20000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLORPALETTE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">COLORPALETTE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Resources in outbreak.info by resource type and source"</span>, subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"As of "</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"%d %B %Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"#777777"</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="researchlibrary_files/figure-html/resources_by_type_source-1.png" width="100%"></p>
</div>
<div id="some-notes-on-constructing-queries" class="section level2">
<h2 class="hasAnchor">
<a href="#some-notes-on-constructing-queries" class="anchor"></a>Some notes on constructing queries</h2>
<p>Our API is built off Elasticsearch, which utilizes Lucene syntax to create queries. As a result, there’s a lot of different and complex queries you can run, if you know the right syntax. Here are a few examples of what you can do; see also the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax">Elasticsearch query syntax</a> for more documentation.</p>
<div id="general-queries" class="section level3">
<h3 class="hasAnchor">
<a href="#general-queries" class="anchor"></a>General queries</h3>
<p>This will search for any use of the term within all the metadata, including its name, description, authors, etc. You can also combine terms using <code>AND</code> and/or <code>OR</code> (must be capitalized). Note that spaces, dashes, and other punctuation are automatically treated as <code>OR</code> combinations. While periods <code>.</code> are used in field names to indicate object structure/nesting (like <code>journalName:Nature</code>; see <a href="#searching-specific-terms">“Searching specific terms”</a>), they will be treated as any other punctuation in general queries. Wildcards <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> can be used (more on this <a href="#using-wildcards">later</a>). Adding quotes will search for that exact term. <strong>Note that all searches are case insensitive, so looking for “Pfizer” or “pfizer” will give you the same results.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Basic query: look for anything that mentions "Pfizer"</span>
<span class="va">query1</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Pfizer"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources containing the term 'Pfizer'"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 1,184 resources containing the term 'Pfizer'"</span>

<span class="co"># Slightly more complicated: lets look what happens when we search for "Pfizer-BioNTech".</span>
<span class="va">query2</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Pfizer-BioNTech"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources containing the term Pfizer-BioNTech. When a search isn't a single word (or is combined by punctuation like hyphens), the words are treated separately, so the results are for any document that has Pfizer OR BioNTech."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 1,227 resources containing the term Pfizer-BioNTech. When a search isn't a single word (or is combined by punctuation like hyphens), the words are treated separately, so the results are for any document that has Pfizer OR BioNTech."</span>

<span class="co"># Let's check that explicitly, by combining Pfizer and BioNTech by `OR`.</span>
<span class="va">query3</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"Pfizer OR BioNTech"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources containing the term Pfizer or BioNTech. Search terms can be combined using ` OR ` to search for either Pfizer or BioNTech."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 1,227 resources containing the term Pfizer or BioNTech. Search terms can be combined using ` OR ` to search for either Pfizer or BioNTech."</span>

<span class="co"># We can fix this by encapsulating the search term in double quotes.  NOTE: don't use single quotes!  They'll be ignored.</span>
<span class="va">query4</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"Pfizer-BioNTech"'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query4</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources containing the exact term Pfizer-BioNTech. Use double (not single!) quotes to search for an exact phrase."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 633 resources containing the exact term Pfizer-BioNTech. Use double (not single!) quotes to search for an exact phrase."</span>

<span class="co"># Terms can also be combined using the word `AND` and using parentheses to group words together. You can create some complex queries that way, like if we were interested in the side effects of two of the approved COVID-19 vaccines.</span>
<span class="va">query5</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'("Pfizer-BioNTech" OR Moderna) AND ("adverse event" OR "adverse events" OR "side effect" OR "side effects")'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query5</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources containing the terms Pfizer-BioNTech or Moderna and some form of adverse events/side effects. Combine search terms using AND or OR and put parentheses around them to group them."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 242 resources containing the terms Pfizer-BioNTech or Moderna and some form of adverse events/side effects. Combine search terms using AND or OR and put parentheses around them to group them."</span></code></pre></div>
</div>
<div id="adjusting-other-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#adjusting-other-parameters" class="anchor"></a>Adjusting other parameters</h3>
<p>In addition to specifying the query string, there are other API parameters you can use to adjust what information is returned. This includes some of the parameters we’ve already used in the examples above, like <code>fetchAll</code> which returns all the results for a given query. Here’s the full list:</p>
<ul>
<li>
<code>types</code>: returns resources of a particular type, like Publication, ClinicalTrial, Dataset, Protocol, Analysis, and more.</li>
<li>
<code>size</code>: how many results are retunred (top 10 by default)</li>
<li>
<code>fetchAll</code>: if TRUE, returns all the results (regardless of what <code>size</code> is)</li>
<li>
<code>fields</code>: which fields (variables) to include in the search results. By default, should be all thes fields. See our <a href="https://discovery.biothings.io/view/outbreak">schemas</a> for the list of all the fields.</li>
<li>
<code>sort</code>: what variable to sort by. Add <code><a href="https://rdrr.io/r/base/Arithmetic.html">-</a></code> in front of the variable name to reverse the sort order (descending)</li>
<li>
<code>facets</code>: counts by a particular variable, as shown in the counting of resource types.</li>
<li>
<code>facet_size</code>: how many results to return in the facets. By default, only the top 10 most frequently observed options will be listed for a given field.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Return only the clinical trials on boosters</span>
<span class="va">query6</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"booster"</span>, types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ClinicalTrial"</span><span class="op">)</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query6</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" clinical trials involving boosters"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 139 clinical trials involving boosters"</span>

<span class="co"># Return the names of the top 20 results, sorted by the newest date</span>
<span class="va">query7</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"booster"</span>, types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ClinicalTrial"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, fields<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"studyStatus.status"</span>, <span class="st">"studyLocation.studyLocationCountry"</span><span class="op">)</span>, sort <span class="op">=</span> <span class="st">"-date"</span><span class="op">)</span>
<span class="va">query7</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Rows: 5</span>
<span class="co">#&gt; Columns: 5</span>
<span class="co">#&gt; $ `_id`         &lt;chr&gt; "NCT04400838", "NCT05047770", "NCT05060562", "NCT0507890…</span>
<span class="co">#&gt; $ date          &lt;date&gt; 2021-10-20, 2021-10-20, 2021-10-20, 2021-10-20, 2021-10…</span>
<span class="co">#&gt; $ name          &lt;chr&gt; "A Phase 2/3 Study to Determine the Efficacy, Safety and…</span>
<span class="co">#&gt; $ studyLocation &lt;list&gt; [&lt;data.frame[20 x 1]&gt;], [&lt;data.frame[1 x 1]&gt;], [&lt;data.f…</span>
<span class="co">#&gt; $ studyStatus   &lt;list&gt; ["active, not recruiting"], ["recruiting"], ["recruitin…</span>


<span class="co"># count what types of interventions are in those clinical trials. Returns the top 25 intervention categories</span>
<span class="va">query8</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"booster"</span>, types<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ClinicalTrial"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0</span>, facets <span class="op">=</span> <span class="st">"interventions.category"</span>, facet_size <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">query8</span><span class="op">$</span><span class="va">facets</span><span class="op">$</span><span class="va">interventions.category</span><span class="op">$</span><span class="va">terms</span> <span class="op">%&gt;%</span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">count</th>
<th align="left">term</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">74</td>
<td align="left">biological</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">other</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="left">behavioral</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="left">drug</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">diagnostic test</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">combination product</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">device</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">dietary supplement</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">procedure</td>
</tr>
</tbody>
</table>
</div>
<div id="using-wildcards" class="section level3">
<h3 class="hasAnchor">
<a href="#using-wildcards" class="anchor"></a>Using wildcards</h3>
<p>Sometimes you only want to search for part of a phrase. For instance, let’s say you wanted to look for resources that have some information on any mutation occurring at position 484 in the spike protein. You can use the <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> wildcard to look for that term.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">query9</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"E484*"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query9</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources mentioning a mutation at position E484."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 370 resources mentioning a mutation at position E484."</span></code></pre></div>
</div>
<div id="using-regular-expressions" class="section level3">
<h3 class="hasAnchor">
<a href="#using-regular-expressions" class="anchor"></a>Using regular expressions</h3>
<p>Even more generically than using a wildcard, you can also construct a query using regular expressions. See the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/regexp-syntax.html">Elasticsearch documentation</a> for how ES implements regex.</p>
</div>
<div id="searching-specific-terms" class="section level3">
<h3 class="hasAnchor">
<a href="#searching-specific-terms" class="anchor"></a>Searching specific terms</h3>
<p>So far, we’ve looked at searches that match any field (variable) within the resource. We might, however, want to look within a particular field rather than searching across everything. Note that nested objects can be queried using <code>.</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># find all publications in Nature</span>
<span class="va">query10</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"journalName:Nature"</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query10</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" COVID-19 publications from Nature."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 1,099 COVID-19 publications from Nature."</span>

<span class="co"># find all resources from Manar Alkuzweny. `author` is an object field, so to access `givenName`, you'll use dot notation</span>
<span class="va">query11</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"author.givenName:Manar AND author.familyName:Alkuzweny."</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query11</span>  <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources authored by Manar."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 3 resources authored by Manar."</span></code></pre></div>
</div>
<div id="finding-records-where-a-term-exists" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-records-where-a-term-exists" class="anchor"></a>Finding records where a term exists</h3>
<p>You might want to know whether or not a field (variable) is empty or populated with something. For instance, we can find all the publications which have some sort of correction associated with them, which could include a retraction or commentary. This is specified by the query parameter <code>_exists_</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">query12</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">"_exists_:correction"</span>, types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Publication"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span>, facets <span class="op">=</span> <span class="st">"correction.correctionType"</span>, facet_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query12</span><span class="op">$</span><span class="va">total</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" publications which have been corrected. Here are the correction types:"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 25,122 publications which have been corrected. Here are the correction types:"</span>

<span class="va">query12</span><span class="op">$</span><span class="va">facets</span><span class="op">$</span><span class="va">correction.correctionType</span><span class="op">$</span><span class="va">terms</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">count</th>
<th align="left">term</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">11765</td>
<td align="left">comment on</td>
</tr>
<tr class="even">
<td align="right">9106</td>
<td align="left">comment in</td>
</tr>
<tr class="odd">
<td align="right">2620</td>
<td align="left">peer-reviewed version</td>
</tr>
<tr class="even">
<td align="right">1812</td>
<td align="left">erratum in</td>
</tr>
<tr class="odd">
<td align="right">1314</td>
<td align="left">update of</td>
</tr>
<tr class="even">
<td align="right">1163</td>
<td align="left">erratum for</td>
</tr>
<tr class="odd">
<td align="right">49</td>
<td align="left">retraction in</td>
</tr>
<tr class="even">
<td align="right">44</td>
<td align="left">retraction of</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="left">update in</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">expression of concern for</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="left">expression of concern in</td>
</tr>
</tbody>
</table>
</div>
<div id="range-searching-dates" class="section level3">
<h3 class="hasAnchor">
<a href="#range-searching-dates" class="anchor"></a>Range searching: dates</h3>
<p>Numeric values like dates can be searched for a specific value, or a range of values. Let’s find the latest research on cytokine storms. With range queries, values in square brackets include those values, like <code>[2020-01-01 TO 2020-12-31]</code> (everything in 2020), curly braces <em>exclude</em> the value on the end, and <code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code> can be added to specify before a date or after a date.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find all resources on cytokine storms</span>
<span class="va">query13</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm"'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Find all cytokine storm research from 18 December 2020. Dates should be specified in YYYY-MM-DD format.</span>
<span class="va">query14</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date:2020-12-18'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Find all cytokine storm research in 2020</span>
<span class="va">query15</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date:[2020-01-01 TO 2020-12-31]'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Find all cytokine storm research after 2020. Note: all these queries are equivalent</span>
<span class="va">query16</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date:{2020-12-31 TO *]'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>
<span class="va">query17</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date: &gt;2020-12-31'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>
<span class="va">query18</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date:[2021-01-01 TO *]'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>
<span class="va">query19</span> <span class="op">=</span> <span class="fu"><a href="../reference/getResourcesData.html">getResourcesData</a></span><span class="op">(</span>query <span class="op">=</span> <span class="st">'"cytokine storm" AND date:&gt;=2021-01-01'</span>, fetchAll <span class="op">=</span> <span class="cn">TRUE</span>, fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"date"</span>, <span class="st">"@type"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"There are "</span>, <span class="va">query13</span>  <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" resources about cytokine storms in all time, "</span>, <span class="va">query14</span>  <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>, <span class="st">" on 18 December 2020, "</span>, <span class="va">query15</span>  <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>, <span class="st">" in 2020"</span>, <span class="st">", and "</span>, <span class="va">query16</span>  <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span>big.mark<span class="op">=</span><span class="st">","</span><span class="op">)</span>,<span class="st">" since 1 January 2021."</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "There are 3,264 resources about cytokine storms in all time, 212 on 18 December 2020, 1,412 in 2020, and 1,852 since 1 January 2021."</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Manar Alkuzweny, Karthik Gangavarapu, Laura Hughes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
